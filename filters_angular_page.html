<!DOCTYPE html>
<html ng-app="myApp">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>My AngularJS App</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet"
          type="text/css"/>
    <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.20/angular.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.2.0/js/bootstrap.min.js"></script>

    <script>
        var myApp = angular.module('myApp', []);
        myApp.controller('SampleController', function ($scope) {

        myApp.filter('expenditurePayeeFilter', [function ($filter) {
                return function (inputArray, searchCriteria, txnType) {
                    if (!angular.isDefined(searchCriteria) || searchCriteria == '') {
                        return inputArray;
                    }
                    var data = [];
                    angular.forEach(inputArray, function (item) {
                        if (item.txnType == txnType) {
                            if (item.$scope.payee.name.toLowerCase().indexOf(searchCriteria.toLowerCase()) != -1) {
                                data.push(item);
                            }
                        }
                    });
                    return data;
                };
        }]);
            $scope.accounts = [
                {id: 11, name: "Bajki", pos: {x: 0, y: 70}},
                {id: 40, name: "Buczka", pos: {x: 1, y: 16}},
                {id: 68, name: "Ciasna", pos: {x: 2, y: 23}},
                {id: 34, name: "Brama Oliwska", pos: {x: 3, y: 17}},
                {id: 52, name: "Chałubińskiego", pos: {x: 4, y: 11}},
                {id: 21, name: "Belgradzka", pos: {x: 4, y: 74}},
                {id: 70, name: "Ciołkowskiego", pos: {x: 6, y: 8}},
                {id: 20, name: "BCB Azymutalna", pos: {x: 9, y: 75}}
//    {id: 1, name: 'Cash'},
//    {id: 2, name: 'Bank Savings'}
            ];
            $scope.payees = [
//    {id:'1',name:'HouseRent', txnType:'EXPENDITURE'},
//    {id: '2', name:'InternetBill', txnType:'EXPENDITURE'},
//    {id:'3', name: 'PowerBill', txnType:'EXPENDITURE'},
//    {id:'4', name: 'Salary', txnType:'INCOME'}
            ];
            $scope.transactions = [
//    {id:'1', txnType:'EXPENDITURE', amount: 1000, account: $scope.accounts[0], payee: $scope.payees[0]},
//    {id:'2', txnType:'EXPENDITURE', amount: 500, account: $scope.accounts[1], payee: $scope.payees[1]},
//    {id:'3', txnType:'EXPENDITURE', amount: 1200, account: $scope.accounts[0], payee: $scope.payees[1]},
//    {id:'4', txnType:'INCOME', amount: 5000, account: $scope.accounts[1], payee: $scope.payees[3]},
//    {id:'5', txnType:'EXPENDITURE', amount:200, account: $scope.accounts[0], payee: $scope.payees[2]}
                {
                    "id": 7, "name": "107",
                    "stops": [
                        {"id": 40, "name": "Buczka"},
                        {"id": 34, "name": "Brama Oliwska"},
                        {"id": 70, "name": "CioĹkowskiego"},
                        {"id": 20, "name": "BCB Azymutalna"},
                        {"id": 44, "name": "Bursztynowa"},
                        {"id": 14, "name": "Banino - Pszenna"},
                        {"id": 73, "name": "Cmentarz Oliwski"},
                        {"id": 7, "name": "Archikatedra Oliwska"},
                        {"id": 57, "name": "ChĹodna"},
                        {"id": 27, "name": "BĹonia"},
                        {"id": 16, "name": "Barniewicka"},
                        {"id": 33, "name": "Bora Komorowskiego"},
                        {"id": 15, "name": "Banino - SzkoĹa"},
                        {"id": 65, "name": "Chwaszczyno Oliwska"},
                        {"id": 9, "name": "AstronautĂłw"},
                        {"id": 32, "name": "Boguckiego"},
                        {"id": 66, "name": "Chwaszczyno Szmaragdowa"},
                        {"id": 4, "name": "al. Hallera"},
                        {"id": 43, "name": "Budzysza"},
                        {"id": 19, "name": "BaĹźyĹskiego"},
                        {"id": 49, "name": "Centrum Medycyny Inwazyjnej"},
                        {"id": 78, "name": "Czerwony DwĂłr"},
                        {"id": 3, "name": "Aksamitna"},
                        {"id": 41, "name": "BudapesztaĹska"},
                        {"id": 22, "name": "Bema"},
                        {"id": 12, "name": "Banino"}],
                    "dTimes": [0, 150, 555, 3165, 1770, 555, 1095, 915, 690, 1590, 2580, 600, 960, 375, 465, 555, 2085, 1320, 3704, 240, 825, 2670, 375, 1275, 825, 1635],
                    "departures": [
                        {"hour": 2, "minutes": 24, "seconds": 0},
                        {"hour": 4, "minutes": 20, "seconds": 0},
                        {"hour": 5, "minutes": 44, "seconds": 0},
                        {"hour": 6, "minutes": 14, "seconds": 0},
                        {"hour": 6, "minutes": 50, "seconds": 0},
                        {"hour": 11, "minutes": 5, "seconds": 0},
                        {"hour": 13, "minutes": 37, "seconds": 0}],
                    "latencies": [5.366469624219462, 34.50718089938164, 37.1092507482972, 58.442813565256074, 47.925141231389716, 36.47320776828565, 27.131624147994444]
                },
                {
                    "id": 8, "name": "108",
                    "stops": [
                        {"id": 50, "name": "Centrum Nadawcze RTV"},
                        {"id": 73, "name": "Cmentarz Oliwski"},
                        {"id": 48, "name": "Centrostal"},
                        {"id": 45, "name": "Bysewo"},
                        {"id": 53, "name": "Charpentiera WisĹoujĹcie"},
                        {"id": 62, "name": "Chrzanowskiego"},
                        {"id": 76, "name": "Czarny DwĂłr"},
                        {"id": 15, "name": "Banino - SzkoĹa"},
                        {"id": 29, "name": "Bogatka"},
                        {"id": 15, "name": "Banino - SzkoĹa"},
                        {"id": 33, "name": "Bora Komorowskiego"},
                        {"id": 9, "name": "AstronautĂłw"},
                        {"id": 55, "name": "CheĹm Cienista"},
                        {"id": 4, "name": "al. Hallera"},
                        {"id": 25, "name": "Biblioteka GĹĂłwna UG"},
                        {"id": 19, "name": "BaĹźyĹskiego"},
                        {"id": 61, "name": "Chodowieckiego"},
                        {"id": 63, "name": "Chwaszczyno"},
                        {"id": 78, "name": "Czerwony DwĂłr"},
                        {"id": 3, "name": "Aksamitna"},
                        {"id": 78, "name": "Czerwony DwĂłr"},
                        {"id": 23, "name": "Beniowskiego"},
                        {"id": 18, "name": "Baza Manipulacyjna"}],
                    "dTimes": [0, 825, 2715, 4020, 4245, 1095, 1995, 465, 60, 60, 960, 420, 1320, 1635, 3660, 285, 465, 735, 2310, 375, 375, 735, 825],
                    "departures": [
                        {"hour": 3, "minutes": 39, "seconds": 0},
                        {"hour": 12, "minutes": 22, "seconds": 0},
                        {"hour": 16, "minutes": 51, "seconds": 0}],
                    "latencies": [46.92847269074991, 95.18130847346038, 30.893575540045276]
                },

                {
                    "id": 9, "name": "109",
                    "stops": [
                        {"id": 30, "name": "Bogatka I"},
                        {"id": 38, "name": "BrÄtowo PKM"},
                        {"id": 16, "name": "Barniewicka"},
                        {"id": 33, "name": "Bora Komorowskiego"},
                        {"id": 26, "name": "Biwakowa"},
                        {"id": 65, "name": "Chwaszczyno Oliwska"},
                        {"id": 26, "name": "Biwakowa"},
                        {"id": 42, "name": "Budowlanych"},
                        {"id": 9, "name": "AstronautĂłw"},
                        {"id": 58, "name": "ChĹopska"},
                        {"id": 47, "name": "Cebertowicza"},
                        {"id": 43, "name": "Budzysza"},
                        {"id": 56, "name": "CheĹm Witosa"},
                        {"id": 61, "name": "Chodowieckiego"},
                        {"id": 74, "name": "CygaĹska GĂłra"},
                        {"id": 10, "name": "Bajana"},
                        {"id": 75, "name": "CystersĂłw"},
                        {"id": 23, "name": "Beniowskiego"},
                        {"id": 22, "name": "Bema"},
                        {"id": 12, "name": "Banino"}],
                    "dTimes": [0, 1635, 1995, 600, 285, 420, 420, 825, 960, 1635, 645, 2580, 645, 690, 105, 3255, 1500, 915, 1005, 1635],
                    "departures": [
                        {"hour": 0, "minutes": 7, "seconds": 0},
                        {"hour": 10, "minutes": 29, "seconds": 0},
                        {"hour": 20, "minutes": 52, "seconds": 0},
                        {"hour": 23, "minutes": 59, "seconds": 0}],
                    "latencies": [14.909054337767884, 4.131228701444343, 69.08868980617262, 75.84812570386566]
                }
            ]
            ;
        });
    </script>

</head>
<div ng-controller="SampleController">
    <br/>
    <div class="col-md-8 col-md-offset-2">
        <form class="form-horizontal" role="form">
            <div class="form-group">
                <label for="input1" class="col-sm-4 control-label">Search by Payee</label>
                <div class="col-sm-6">
                    <input type="text" class="form-control" id="input1" placeholder="Payee Name"
                           ng-model="filterTxn.payee.name">
                </div>
            </div>

            <div class="form-group">
                <label for="input2" class="col-sm-4 control-label">Wybierz przystanek</label>
                <div class="col-sm-6">
                    <select id="input2" class="form-control" ng-model="filterTxn.account">
                        <option value="">Przystanki</option>
                        <option ng-repeat="item in accounts" value="{{item.id}}">{{item.name}}</option>
                    </select>
                </div>
            </div>

            <!--<div class="form-group">-->
                <!--<label for="input3" class="col-sm-4 control-label">Search By Type</label>-->
                <!--<div class="col-sm-6">-->
                    <!--<select id="input3" class="form-control" ng-model="filterTxn.txnType">-->
                        <!--<option value="">All Types</option>-->
                        <!--<option value="EXPENDITURE">EXPENDITURE</option>-->
                        <!--<option value="INCOME">INCOME</option>-->
                    <!--</select>-->
                <!--</div>-->
            <!--</div>-->

            <div class="form-group">
                <label for="input4" class="col-sm-4 control-label">Search by Expenditure Payees</label>
                <div class="col-sm-6">
                    <input id="input4" type="text" class="form-control" ng-model="searchCriteria">
                </div>
            </div>

        </form>
        <h3>Lista autobusów</h3>
        <table class="table table-striped table-bordered">
            <thead>
            <tr>
                <th>#</th>
                <th>Account</th>
                <th>Type</th>
                <th>Payee</th>
                <th>Amount</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="name in transactions| filter: filterTxn | expenditurePayeeFilter:searchCriteria:'name'">
                <td>{{$index + 1}}</td>
                <td>{{txn.account.name}}</td>
                <td>{{txn.txnType}}</td>
                <td>{{txn.payee.name}}</td>
                <td>{{txn.$scope.transactions.departures}}</td>
            </tr>
            </tbody>
        </table>
    </div>

</div>
</html>